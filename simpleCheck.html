<!DOCTYPE html>
<html>
<head><title>Simple IndexedDB Check</title></head>
<body>
<div id='result'>Checking userData in IndexedDB...</div>
<script>
async function checkUserData() {
  const resultDiv = document.getElementById('result');
  
  try {
    const db = await new Promise((resolve, reject) => {
      const request = indexedDB.open('FreshStartDB', 1);
      request.onsuccess = () => resolve(request.result);
      request.onerror = () => resolve(null);
      request.onupgradeneeded = () => {
        resultDiv.innerHTML = '❌ Database does not exist (onupgradeneeded fired)';
        resolve(null);
      };
    });
    
    if (!db) return;
    
    const transaction = db.transaction(['userData'], 'readonly');
    const store = transaction.objectStore('userData');
    
    const userData = await new Promise((resolve, reject) => {
      const request = store.get('current');
      request.onsuccess = () => resolve(request.result);
      request.onerror = () => resolve(null);
    });
    
    if (userData && userData.data) {
      resultDiv.innerHTML = `✅ userData EXISTS in IndexedDB<br>Data length: ${userData.data.length} chars<br>Preview: ${userData.data.substring(0, 200)}...`;
    } else {
      resultDiv.innerHTML = '❌ NO userData found in IndexedDB';
    }
    
    db.close();
    
  } catch(e) {
    resultDiv.innerHTML = `Error: ${e.message}`;
  }
}
checkUserData();
</script>
</body>
</html>
